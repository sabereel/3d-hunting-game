<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>3D Hunting Simulator</title>
  <style>
    body { margin:0; overflow:hidden; }
    canvas { display:block; }
    #hud {
      position:absolute;
      top:10px;
      left:10px;
      color:white;
      font-family:sans-serif;
      z-index:10;
    }
  </style>
</head>
<body>
  <div id="hud">Weapon: .22 Rifle | Money: $0 | Health: 100</div>

  <!-- Three.js library -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r152/three.min.js"></script>

  <!-- PointerLockControls -->
  <script src="https://cdn.jsdelivr.net/npm/three@0.152.2/examples/js/controls/PointerLockControls.js"></script>

  <script>
  // ===== THREE.JS SETUP =====
  const scene = new THREE.Scene();
  const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
  camera.position.set(0,2,5);

  const renderer = new THREE.WebGLRenderer({antialias:true});
  renderer.setSize(window.innerWidth, window.innerHeight);
  document.body.appendChild(renderer.domElement);

  // ===== LIGHT =====
  const light = new THREE.DirectionalLight(0xffffff, 1);
  light.position.set(5,10,7);
  scene.add(light);

  const ambient = new THREE.AmbientLight(0x404040);
  scene.add(ambient);

  // ===== GROUND =====
  const groundGeo = new THREE.PlaneGeometry(200,200);
  const groundMat = new THREE.MeshPhongMaterial({color:0x228B22});
  const ground = new THREE.Mesh(groundGeo, groundMat);
  ground.rotation.x = -Math.PI/2;
  scene.add(ground);

  // ===== RIVERS/LAKES =====
  const waterGeo = new THREE.PlaneGeometry(20,10);
  const waterMat = new THREE.MeshPhongMaterial({color:0x1E90FF});
  const lake = new THREE.Mesh(waterGeo, waterMat);
  lake.rotation.x = -Math.PI/2;
  lake.position.set(30,0.01,30);
  scene.add(lake);

  // ===== CONTROLS =====
  const controls = new THREE.PointerLockControls(camera, document.body);
  document.addEventListener('click', () => controls.lock());

  // ===== PLAYER =====
  const player = {health:100, money:0, weapon:'.22 Rifle'};
  const hud = document.getElementById('hud');

  function updateHUD() {
    hud.innerHTML = `Weapon: ${player.weapon} | Money: $${player.money} | Health: ${player.health}`;
  }

  // ===== ANIMALS =====
  const animals = [];
  const footprints = [];
  const bloodTrails = [];

  function spawnAnimal(x,z,type='deer'){
    const geo = new THREE.BoxGeometry(1,1,2);
    const mat = new THREE.MeshPhongMaterial({color:type==='deer'?0x8B4513:0x555555});
    const mesh = new THREE.Mesh(geo, mat);
    mesh.position.set(x,0.5,z);
    mesh.userData = {health:100,type:type};
    scene.add(mesh);
    animals.push(mesh);
  }

  // spawn some animals
  for(let i=0;i<5;i++){
    spawnAnimal(Math.random()*50-25, Math.random()*50-25);
  }

  // ===== FOOTPRINTS =====
  function addFootprint(x,z){
    const geo = new THREE.PlaneGeometry(0.3,0.3);
    const mat = new THREE.MeshBasicMaterial({color:0xAAAAAA, transparent:true, opacity:1});
    const fp = new THREE.Mesh(geo,mat);
    fp.rotation.x=-Math.PI/2;
    fp.position.set(x,0.01,z);
    fp.age=0; // track age
    scene.add(fp);
    footprints.push(fp);
  }

  // ===== BLOOD TRAILS =====
  function addBlood(x,z){
    const geo = new THREE.PlaneGeometry(0.2,0.2);
    const mat = new THREE.MeshBasicMaterial({color:0xff0000});
    const blood = new THREE.Mesh(geo,mat);
    blood.rotation.x=-Math.PI/2;
    blood.position.set(x,0.01,z);
    scene.add(blood);
    bloodTrails.push(blood);
  }

  // ===== SHOOTING & ZOOM =====
  document.addEventListener('mousedown',(e)=>{
    if(e.button===0){ // left click = shoot
      const raycaster = new THREE.Raycaster();
      raycaster.setFromCamera(new THREE.Vector2(0,0), camera);
      const hits = raycaster.intersectObjects(animals);
      if(hits.length>0){
        const target = hits[0].object;
        const localY = hits[0].point.y - target.position.y;
        // Vital hits
        if(localY>0.8) target.userData.health -=100; // head
        else if(localY>0.4) target.userData.health -=70; // lung
        else target.userData.health -=50; // body
        addBlood(target.position.x, target.position.z);
      }
    } else if(e.button===2){ // right click = zoom
      if(camera.fov===75) camera.fov=20;
      else camera.fov=75;
      camera.updateProjectionMatrix();
    }
  });

  // ===== ANIMATION LOOP =====
  function animate(){
    requestAnimationFrame(animate);

    // animal wandering + footprints
    animals.forEach(a=>{
      a.position.x += (Math.random()-0.5)*0.05;
      a.position.z += (Math.random()-0.5)*0.05;
      if(Math.random()<0.05){
        addFootprint(a.position.x, a.position.z);
      }
      if(a.userData.health<=0){
        scene.remove(a);
        player.money += 50; // money for kill
      }
    });
    animals.filter(a=>a.userData.health>0);

    // age footprints
    footprints.forEach(fp=>{
      fp.age +=0.01;
      fp.material.opacity = Math.max(0,1-fp.age/50); // fades slowly
    });

    updateHUD();
    renderer.render(scene,camera);
  }
  animate();

  // ===== RESIZE =====
  window.addEventListener('resize', ()=>{
    camera.aspect = window.innerWidth/window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(window.innerWidth, window.innerHeight);
  });
  </script>
</body>
</html>
